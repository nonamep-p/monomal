#!/bin/bash

THEME_DIR="$HOME/.config/neofetch/themes"
CONFIG_FILE="$HOME/.config/neofetch/config.conf"

# Ensure themes exist
if [ ! -d "$THEME_DIR" ]; then
    echo "Themes directory not found!"
    exit 1
fi

# Select with fzf and preview
# We search recursively for .conf files
# --preview runs neofetch with that config
# --preview-window=right:70% gives plenty of space for the art
SELECTED=$(find "$THEME_DIR" -name "*.conf" | fzf \
    --prompt="Select Theme > " \
    --height=100% \
    --layout=reverse \
    --border \
    --preview "neofetch --config {}" \
    --preview-window=right:70% \
    --delimiter / \
    --with-nth -1)

if [ -n "$SELECTED" ]; then
    cp "$SELECTED" "$CONFIG_FILE"
    clear
    neofetch
    echo -e "\n\033[1;32mTheme applied: $(basename "$SELECTED")\033[0m"
else
    echo "No theme selected."
fi
